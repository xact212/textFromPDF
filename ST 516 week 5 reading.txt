Page 1[DO NOT INCLUDE PAGE # IN FULL TEXT]
Model-Based Theory for Cluster Sampling* 201
Note thatρin (5.39) is always nonnegative, in contrast to the design-based ICC, which can
take on negative values.
μσΑ
Average cost for 
hospital 2, μ + A2Average cost for hospital 1, μ + A
1××
×
μ + A1σ
Cost for particular 
birth at hospital 1
×
μ + A2σ
Cost for particular 
birth at hospital 2
FIGURE 5.8
Illustration of random eﬀects for hospitals and births.
Figure 5.8 illustrates Model M1, assuming that all random variables are normally dis-
tributed, for a two-stage cluster sample taken to estimate the total amount of hospital
charges in a country for delivering babies. Hospitals are sampled at the ﬁrst stage, and
birth records from the selected hospitals are sampled at the second stage (twins and triplets
count as one record). The average charge per birth varies from hospital to hospital—some
hospitals may have higher personnel costs, and others may serve a higher-risk population
or have more expensive equipment. That variation is reﬂected in model M1 by the random
variablesAi:µ+Airepresents the average cost per birth in the ith hospital, and σ2
Ais the
population variance among the hospital means. In addition, costs vary from birth to birth
within the hospitals; that variation is incorporated into the model by the term εijwith
varianceσ2.
Costsforbirthsinthesamehospitaltendtobemoresimilarthancostsforbirthsselected
randomly across the entire population of hospital births, because the cost for a birth in a
Page 2[DO NOT INCLUDE PAGE # IN FULL TEXT]
202 Cluster Sampling with Equal Probabilities
given hospital incorporates the hospital-speciﬁc characteristics such as personnel costs. This
similarity induces a positive correlation among observations in the same cluster.
5.6.1 Estimation Using Models
Now let’s ﬁnd properties of various estimators under Model M1. As in Sections 2.10 and 3.6,
we want to predict the unsampled population members in the random variable representing
the ﬁnite population total, which for cluster sampling is
T=N
i=1Mi
j=1Yij.
All of the estimators we consider have the form
ˆT=
i∈S
j∈SibijYij, (5.40)
where thebijs are a set of constants, so let’s derive the model-based bias and variance for
this general estimator and then substitute the values of bijfor speciﬁc estimators later.
Inference in a model-based approach is conditional on the units selected to be in the
sample; that is, the inference treats SandSias ﬁxed, and treats Yijas a random variable.
The bias of the general estimator ˆTunder model M1 is
EM1[ˆT−T] =EM1)
)
i∈S
j∈SibijYij−N
i=1Mi
j=1Yij(
[=µ

i∈S
j∈Sibij−M0(
(.(5.41)
Thus, ˆTis model-M1-unbiased when∑
i∈S∑
j∈Sibij=M0. The model-based (for
model M1) variance of ˆT−Tis (see Exercise 34):
VM1[ˆT−T] =σ2
A)
])
i∈S

j∈Sibij−Mi(
(2
+
i/∈SM2
i(
[+σ2)
)
i∈S
j∈Si(b2
ij−2bij) +M0(
[.
(5.42)
Properties of design-based estimators under Model M1. Now let’s look at what happens
with the design-based estimators we studied in Section 5.3 under Model M1. The random
variable corresponding to the design-unbiased estimator ˆtunbin (5.21) is
ˆTunb=
i∈S
j∈SiNMi
nmiYij;
the coeﬃcients bijare the sampling weights (NMi)/(nmi). Using (5.41), the model-based
bias of ˆTunbis
EM1[ˆTunb−T] =µ

i∈S
j∈SiNMi
nmi−M0(
(=µ(
N
n
i∈SMi−M0(
.
The bias depends on which sample is taken, and the estimator is model-unbiased under
(5.38) only when the average of the Mis in the sample equals the average of the Mis in the
population, such as will occur when all Mis are the same.
Page 3[DO NOT INCLUDE PAGE # IN FULL TEXT]
Model-Based Theory for Cluster Sampling* 203
The ratio estimator corresponding to M0ˆ¯yr, for ˆ¯yrin (5.16), is
ˆTr=
i∈S
j∈Si(
M0Mi
mi∑
k∈SMk{
Yij.
Since∑
i∈S∑
j∈Si(M0Mi)/(mi∑
k∈SMk) =M0,ˆTris model-unbiased under Model M1. If
the sample consists of the population units with the largest values of Mi, the ratio estimator
compensates by dividing by the sum of the Mifor the sample, which will also be large.
Best linear unbiased predictor under Model M1. If Model M1 really does describe the
population and the Mis are unequal, one can ﬁnd an estimator with smaller variance than
both ˆTunband ˆTr.
In a model-based perspective, it is desired to predict the values of Yijfor the unobserved
population members. Exercises 35 and 36 show that among all model-unbiased predictors
having the form of (5.40), ˆTBLUPin (5.43) has the smallest variance:
ˆTBLUP =
i∈S

j∈SiYij+
j̸∈SiˆYij(
(+
i̸∈SMi
j=1ˆYij
=
i∈S
j∈SiYij+
i∈S
j̸∈Si)
ραi1
mi
l∈SiYil+ (1−ραi)ˆµ[
+
i̸∈SMiˆµ,(5.43)
whereαi=mi/[1 +ρ(mi−1)]and
ˆµ=

i∈Sαi
j∈SiYij
mi(
(/(
i∈Sαi(
. (5.44)
Typically,ρis unknown, and an estimator ˆρis substituted into (5.43) and (5.44).
The unknown mean µis estimated by a weighted average of the sample psu means, with
αiproportional to 1/VM1(∑
j∈SiYij/mi). Thus, the estimated mean ˆµrelies more heavily
on the sample means from psus with larger sample sizes mi, which have smaller variance
under model M1. If psu iis not in the sample, then ˆYij= ˆµ. If psuiis in the sample but
ssujis not, ˆYijis predicted as a value somewhere between the sample mean of psu iand
the overall mean ˆµ.
Ifn/Nis small, ˆTBLUP≈M0ˆµ. Under model M1, after all, every population unit has
expected value µ, so if the number of psus in the sample is small relative to the number of
psus in the population, it makes sense that the population mean would be approximately
estimated by ˆµand the total by the population size times ˆµ.
IfMi=Mandmi=mfor alli, then ˆµ=∑
i∈S∑
j∈SiYij/(nm), ˆTunb=ˆTr=ˆTBLUP =
M0ˆµ, and the variance in (5.42) simpliﬁes to
VM1[ˆTunb−T] =M2
0(
1−n
N{σ2
A
n+M2
0(
1−nm
NM{σ2
mn. (5.45)
Model assumptions. The assumptions for model-based inference are strong. For Model
M1, we assume:
1. Themodelformiscorrect,thatis, Yij=µ+Ai+εijforeveryunit (i,j)inthepopulation,
whether sampled or not. One consequence is that the expected value of the total in psu i,
E∑Mi
j=1Yij
, is assumed to equal Miµ.
Page 4[DO NOT INCLUDE PAGE # IN FULL TEXT]
204 Cluster Sampling with Equal Probabilities
2. The proposed variance and correlation structures are correct, that is, V(Yij) =σ2
A+σ2,
Corr (Yij,Yil) =ρfor unitsj̸=lin the same cluster, and Corr (Yij,Ykl) = 0for units
in diﬀerent clusters.
In a model-based approach, it does not matter which population units are in the sample
because all population units are assumed to follow the model. For that reason, data from a
nonprobability sample must be analyzed using models, as discussed in Chapter 15.
Butwhathappensifthemodelisinappropriateforthepopulation?Wecan(andshould!)
perform model diagnostics (see, for example, Demidenko, 2013; Loy et al., 2017) to examine
howwellthemodelﬁtstheunitsinthesample,butunlessadditionalinformationisavailable
about the units not sampled, we cannot assess whether the model is appropriate for unob-
served units. A model-based analyst must assume that the model ﬁts the population units
that are not observed. If psus and ssus are selected using simple random sampling, then it
is reasonable to assume that a model that ﬁts the observed units also ﬁts the unobserved
units since there is nothing “special” about the units that end up in the sample.
With a convenience sample, however, the psus in the sample may diﬀer systematically
from those not in the sample—for example, the sampled hospitals in Figure 5.8 might be
larger or more urban than nonsampled hospitals—and hence predictions of the unobserved
records in unsampled hospitals may be biased. The model-based variance, estimated from
the data in the sample, does not capture that bias. Thus, if the model does not ﬁt the
unsampled units, the model-based variance can severely underestimate the mean squared
error and give the impression that estimates are more accurate than they really are.
That said, Model M1 is a reasonable approximation for many real-life situations in which
there is clustering, and it is widely used in practice for nonprobability samples of clusters.
Available auxiliary information can be included in the model to improve prediction, as
in Section 4.6. Of course, many other models have been proposed that assume units are
dependent; see the For Further Reading section for references.
You can use various estimators in conjunction with a model-based approach. Thus, you
can estimate the population total by ˆTunb,ˆTr,ˆTBLUP, or another estimator. But the sta-
tistical properties of the estimator come from the assumed model. In practice, if estimating
multiple quantities or statistics for domains, it may be desirable to use an estimator in
which the constants bijare the same for every yvariable, even if the variance is higher
than that of ˆTBLUP. The constants used in (5.43), which are given explicitly in Exercise 36,
can diﬀer for each response variable when the mivary from psu to psu. Thus, if you use
ˆTBLUPto estimate the total hospital charges for California, the total hospital charges for
Oregon, and the total hospital charges for California and Oregon together, the combined
California–Oregon total might not equal the sum of the individual totals for the two states.
If the constants bijare the same for every response variable, this problem will not occur.
Example 5.14. Let’s ﬁt Model M1 to the schools data from Example 5.7. Looking at
Figure5.3,itseemsplausiblethatthewithin-schoolvariances σ2
iarethesameforallschools.
Using statistical software for mixed models, we obtain estimated variance components ˆσ2
A=
33.85andˆσ2= 102.83. This results in ˆρ= 33.85/(33.85 + 102 .83) = 0.25, approximately
the same as the value of R2
ain Example 5.8. Most software packages for mixed models
estimateµusing (5.44). For the schools data, mi= 20students are sampled from each psu,
soˆµ= 34.66 is the average of the individual school means in Table 5.7. The model-based
standard error of ˆµis 1.97. Note that ˆµis slightly larger than ˆ¯yr= 33.12from Example 5.7.
The model-based standard error, however, diﬀers from the design-based standard error of
1.76; the model-based standard error estimates variability under M1, while the design-based
standard error estimates variability under repeated sampling with the sampling design. ■
Page 5[DO NOT INCLUDE PAGE # IN FULL TEXT]
Chapter Summary 205
5.6.2 Design Using Models
Models are extremely useful for designing a cluster sample. Using a model for design does
not mean you have to use a model for analysis of your survey data after it is collected;
rather, the model provides a useful way of summarizing information you can use to make
the survey design more eﬃcient.
SupposethatModelM1seemsreasonableforyourpopulationandthatallpsusizesinthe
population are equal. Then you would like to design the survey to minimize the variance
in (5.45), subject to cost constraints. Using the cost function in (5.35), the model-based
variance is minimized when
m=∫
c1σ2
c2σ2
A.
Suppose that the Mis are unequal and that Model M1 holds. We can use the variance
in (5.42) to determine the optimal subsampling size mifor each cluster. This approach
was used by Royall (1976) for more general models than considered in this section. For ˆTr,
bij=Mi/(mi∑
k∈SMk), and the variance is minimized when miis proportional to Mi(see
Exercise 39).
5.7 Chapter Summary
Cluster sampling is commonly used in large surveys, but estimates obtained from cluster
samples usually have greater variance than if we were able to measure the same number
of observation units using an SRS. If it is much less expensive to sample clusters than
individual elements, though, cluster sampling can provide more precision per dollar spent.
All of the formulas in this chapter for cluster sampling with equal probabilities are
special cases of the general results for two-stage cluster sampling with unequal psu sizes, to
be derived in Chapter 6. They can be applied to any two-stage cluster sample in which the
psus are selected with equal probability. These formulas were given in (5.21), (5.27), (5.30),
and (5.32) and are repeated here:
ˆtunb=N
n
i∈Sˆti=N
n
i∈SMi¯yi, (5.46)
ˆV(ˆtunb) =N2(
1−n
N{s2
t
n+N
n
i∈S(
1−mi
Mi{
M2
is2
i
mi, (5.47)
ˆ¯yr=
i∈SMi¯yi

i∈SMi, (5.48)
ˆV(ˆ¯yr) =1
M2)(
1−n
N{s2
r
n+1
nN
i∈S(
1−mi
Mi{
M2
is2
i
mi[
, (5.49)
withM=∑
i∈SMi/n,
s2
t=1
n−1
i∈S(
ˆti−ˆtunb
N{2
